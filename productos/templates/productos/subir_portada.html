{% extends 'productos/base_producto.html' %}
{% load static %}

{% block title %}Subir Portada · Tienda Plus{% endblock %}

{% block producto_content %}
<style>
  .portada-hero {
    background: linear-gradient(135deg, #6610f2, #0d6efd);
    color: #fff;
    border-radius: 1rem;
    box-shadow: 0 10px 20px rgba(0,0,0,.15);
  }
  .portada-card {
    border: 0;
    border-radius: 1rem;
    box-shadow: 0 12px 28px rgba(0,0,0,.12);
  }
  .form-label { font-weight: 600; }
  .form-control {
    border-radius: .5rem;
    box-shadow: inset 0 1px 2px rgba(0,0,0,.05);
  }
  .preview-img {
    width: 200px;
    height: 140px;
    object-fit: cover;
    border-radius: .75rem;
    box-shadow: 0 6px 12px rgba(0,0,0,.08);
  }
</style>

<div class="container py-4">

  <!-- Hero superior -->
  <div class="portada-hero p-4 p-md-5 mb-4 text-center">
    <h1 class="h3 mb-2"><i class="bi bi-image-fill me-2"></i>Subir portada</h1>
    <p class="mb-0 opacity-75">Seleccioná una imagen para destacar tu producto en el catálogo.</p>
  </div>

  <!-- Mensajes -->
  {% if messages %}
    <div class="mb-3">
      {% for message in messages %}
        <div class="alert alert-{{ message.tags }} alert-dismissible fade show d-flex align-items-center" role="alert">
          <i class="bi bi-info-circle-fill me-2"></i>{{ message }}
          <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Cerrar"></button>
        </div>
      {% endfor %}
    </div>
  {% endif %}

  <!-- Tarjeta de formulario -->
  <div class="row justify-content-center">
    <div class="col-md-8 col-lg-6">
      <div class="card portada-card">
        <div class="card-body p-4">
          <form method="post" enctype="multipart/form-data" novalidate>
            {% csrf_token %}

            <!-- Campo de portada -->
            <div class="mb-3">
              <label for="{{ form.portada.id_for_label }}" class="form-label"><i class="bi bi-upload me-1"></i>Seleccionar imagen</label>
              {{ form.portada }}
              {% if form.portada.errors %}
                <div class="text-danger small mt-1"><i class="bi bi-exclamation-circle me-1"></i>{{ form.portada.errors|striptags }}</div>
              {% endif %}
            </div>

            <!-- Vista previa de imagen actual -->
            {% if producto.portada and producto.portada.url %}
              <div class="mb-3 text-center">
                <p class="mb-1 text-muted">Imagen actual:</p>
                <img src="{{ producto.portada.url }}" alt="{{ producto.nombre }}" class="preview-img">
              </div>
            {% endif %}

            <!-- Botones -->
            <div class="mt-4 d-flex justify-content-between align-items-center">
              <button type="submit" class="btn btn-success btn-icon">
                <i class="bi bi-check-circle-fill me-1"></i>Guardar portada
              </button>
              <a href="{% url 'productos:producto_list' %}" class="btn btn-secondary btn-icon">
                <i class="bi bi-arrow-left-circle me-1"></i>Cancelar
              </a>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>

</div>
{% endblock %}
