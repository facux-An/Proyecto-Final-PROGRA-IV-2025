{% extends 'ventas/base_ventas.html' %}
{% load static %}

{% block title %}Carrito ¬∑ Tienda Plus{% endblock %}

{% block content %}
<style>
  .carrito-hero {
    background: linear-gradient(135deg, #0d6efd, #20c997);
    color: #fff;
    border-radius: 1rem;
    box-shadow: 0 10px 20px rgba(0,0,0,.15);
  }
  .table-modern {
    border-radius: 1rem;
    overflow: hidden;
    box-shadow: 0 12px 28px rgba(0,0,0,.12);
  }
  .table-modern thead {
    background: #212529;
    color: #fff;
  }
  .table-modern tbody tr {
    transition: background-color .15s ease;
  }
  .table-modern tbody tr:hover {
    background-color: rgba(13,110,253,.06);
  }
  .badge-soft {
    border-radius: .5rem;
    font-size: .85rem;
    padding: .35em .65em;
  }
  .empty-state {
    border-radius: 1rem;
    box-shadow: 0 10px 20px rgba(0,0,0,.08);
  }
</style>

<div class="container py-4">

  <!-- Hero superior -->
  <div class="carrito-hero p-4 p-md-5 mb-4 text-center">
    <h1 class="h3 mb-2"><i class="bi bi-cart-check-fill me-2"></i>Tu carrito</h1>
    <p class="mb-0 opacity-75">Revis√° tus productos antes de finalizar la compra.</p>
  </div>

  {% if carrito %}
    <!-- Tabla de productos en el carrito -->
    <div class="table-responsive mb-4">
      <table class="table table-modern align-middle text-center">
        <thead>
          <tr>
            <th><i class="bi bi-box-seam me-1"></i>Producto</th>
            <th><i class="bi bi-stack me-1"></i>Cantidad</th>
            <th><i class="bi bi-currency-dollar me-1"></i>Precio</th>
            <th><i class="bi bi-calculator me-1"></i>Total</th>
          </tr>
        </thead>
        <tbody>
          {% for item in carrito %}
            <tr>
              <td class="fw-semibold">{{ item.producto.nombre }}</td>
              <td>{{ item.cantidad }}</td>
              <td>${{ item.producto.precio }}</td>
              <td class="fw-bold text-success">${{ item.total }}</td>
            </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>

    <!-- Total del carrito -->
    <div class="text-end mb-4">
      <h5 class="fw-bold">Total del carrito: <span class="text-primary">${{ total_carrito }}</span></h5>
    </div>

    <!-- Botones de acci√≥n -->
    <div class="d-flex flex-wrap justify-content-center gap-3">
      <!-- Bot√≥n finalizar compra -->
      <form id="form-finalizar-compra" method="post" action="{% url 'carrito:finalizar' %}" class="d-inline">
        {% csrf_token %}
        <button type="submit" class="btn btn-primary btn-lg btn-icon shadow-sm">
          <i class="bi bi-cart-check-fill me-1"></i>Finalizar compra
        </button>
      </form>

      <!-- Bot√≥n elegir m√©todo de pago -->
      <a href="{% url 'pagos:metodo' %}" class="btn btn-success btn-lg btn-icon shadow-sm">
        <i class="bi bi-credit-card-fill me-1"></i>Elegir m√©todo de pago
      </a>
    </div>

  {% else %}
    <!-- Estado vac√≠o elegante -->
    <div class="p-5 mb-4 bg-light text-center empty-state">
      <div class="display-6 mb-3">üõí</div>
      <h4 class="text-muted">Tu carrito est√° vac√≠o</h4>
      <p class="text-secondary">Agreg√° productos desde el cat√°logo para comenzar tu compra.</p>
      <a href="{% url 'productos:producto_list' %}" class="btn btn-outline-primary btn-icon mt-3">
        <i class="bi bi-box-seam me-1"></i>Ver productos
      </a>
    </div>
  {% endif %}

</div>
{% endblock %}
